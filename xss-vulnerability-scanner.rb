require 'mechanize'
require 'nokogiri'

class XSSScanner
  def initialize(url)
    @url = url
    @agent = Mechanize.new
  end

  def check_for_xss
    page = @agent.get(@url)
    form = page.forms.first
    form.fields.each do |field|
      original_value = field.value
      field.value = "<script>alert('XSS')</script>"
      begin
        page = form.submit
        if page.body.include? "alert('XSS')"
          puts "XSS vulnerability found on #{@url} in #{field.name} field"
        end
      rescue Mechanize::ResponseCodeError => e
        puts "Error: #{e.response_code}"
      ensure
        field.value = original_value
      end
    end
  end
end

scanner = XSSScanner.new("https://xss-game.appspot.com/level1/frame")
scanner.check_for_xss
